function e(n){var t,r,a=new Error(n);return t=a,r=e.prototype,Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r,a}function n(n,t,r){var a=t.slice(0,r).split(/\n/),i=a.length,c=a[i-1].length+1;throw e(n+=" at line "+i+" col "+c+":\n\n  "+t.split(/\n/)[i-1]+"\n  "+Array(c).join(" ")+"^")}e.prototype=Object.create(Error.prototype,{name:{value:"Eta Error",enumerable:!1}});var t=new Function("return this")().Promise;function r(e,n){for(var t in n)r=n,a=t,Object.prototype.hasOwnProperty.call(r,a)&&(e[t]=n[t]);var r,a;return e}function a(e,n,t,r){var a,i;return Array.isArray(n.autoTrim)?(a=n.autoTrim[1],i=n.autoTrim[0]):a=i=n.autoTrim,(t||!1===t)&&(a=t),(r||!1===r)&&(i=r),i||a?"slurp"===a&&"slurp"===i?e.trim():("_"===a||"slurp"===a?e=function(e){return String.prototype.trimLeft?e.trimLeft():e.replace(/^\s+/,"")}(e):"-"!==a&&"nl"!==a||(e=e.replace(/^(?:\r\n|\n|\r)/,"")),"_"===i||"slurp"===i?e=function(e){return String.prototype.trimRight?e.trimRight():e.replace(/\s+$/,"")}(e):"-"!==i&&"nl"!==i||(e=e.replace(/(?:\r\n|\n|\r)$/,"")),e):e}var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function c(e){return i[e]}var s=/`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g,o=/'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g,l=/"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g;function u(e){return e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function p(e,t){var r=[],i=!1,c=0,p=t.parse;if(t.plugins)for(var f=0;f<t.plugins.length;f++){(O=t.plugins[f]).processTemplate&&(e=O.processTemplate(e,t))}function d(e,n){e&&(e=a(e,t,i,n))&&(e=e.replace(/\\|'/g,"\\$&").replace(/\r\n|\n|\r/g,"\\n"),r.push(e))}t.rmWhitespace&&(e=e.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),s.lastIndex=0,o.lastIndex=0,l.lastIndex=0;for(var g,h=[p.exec,p.interpolate,p.raw].reduce((function(e,n){return e&&n?e+"|"+u(n):n?u(n):e}),""),v=new RegExp("([^]*?)"+u(t.tags[0])+"(-|_)?\\s*("+h+")?\\s*","g"),m=new RegExp("'|\"|`|\\/\\*|(\\s*(-|_)?"+u(t.tags[1])+")","g");g=v.exec(e);){c=g[0].length+g.index;var x=g[1],y=g[2],_=g[3]||"";d(x,y),m.lastIndex=c;for(var w=void 0,E=!1;w=m.exec(e);){if(w[1]){var b=e.slice(c,w.index);v.lastIndex=c=m.lastIndex,i=w[2],E={t:_===p.exec?"e":_===p.raw?"r":_===p.interpolate?"i":"",val:b};break}var I=w[0];if("/*"===I){var R=e.indexOf("*/",m.lastIndex);-1===R&&n("unclosed comment",e,w.index),m.lastIndex=R}else if("'"===I){o.lastIndex=w.index,o.exec(e)?m.lastIndex=o.lastIndex:n("unclosed string",e,w.index)}else if('"'===I){l.lastIndex=w.index,l.exec(e)?m.lastIndex=l.lastIndex:n("unclosed string",e,w.index)}else if("`"===I){s.lastIndex=w.index,s.exec(e)?m.lastIndex=s.lastIndex:n("unclosed string",e,w.index)}}E?r.push(E):n("unclosed tag",e,g.index+x.length)}if(d(e.slice(c,e.length),!1),t.plugins)for(f=0;f<t.plugins.length;f++){var O;(O=t.plugins[f]).processAST&&(r=O.processAST(r,t))}return r}function f(e,n){var t=p(e,n),r="var tR='',__l,__lP"+(n.include?",include=E.include.bind(E)":"")+(n.includeFile?",includeFile=E.includeFile.bind(E)":"")+"\nfunction layout(p,d){__l=p;__lP=d}\n"+(n.useWith?"with("+n.varName+"||{}){":"")+function(e,n){var t=0,r=e.length,a="";for(;t<r;t++){var i=e[t];if("string"==typeof i){a+="tR+='"+i+"'\n"}else{var c=i.t,s=i.val||"";"r"===c?(n.filter&&(s="E.filter("+s+")"),a+="tR+="+s+"\n"):"i"===c?(n.filter&&(s="E.filter("+s+")"),n.autoEscape&&(s="E.e("+s+")"),a+="tR+="+s+"\n"):"e"===c&&(a+=s+"\n")}}return a}(t,n)+(n.includeFile?"if(__l)tR="+(n.async?"await ":"")+"includeFile(__l,Object.assign(".concat(n.varName,",{body:tR},__lP))\n"):n.include?"if(__l)tR="+(n.async?"await ":"")+"include(__l,Object.assign(".concat(n.varName,",{body:tR},__lP))\n"):"")+"if(cb){cb(null,tR)} return tR"+(n.useWith?"}":"");if(n.plugins)for(var a=0;a<n.plugins.length;a++){var i=n.plugins[a];i.processFnString&&(r=i.processFnString(r,n))}return r}var d=new(function(){function e(e){this.cache=e}return e.prototype.define=function(e,n){this.cache[e]=n},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.reset=function(){this.cache={}},e.prototype.load=function(e){r(this.cache,e)},e}())({});var g={async:!1,autoEscape:!0,autoTrim:[!1,"nl"],cache:!1,e:function(e){var n=String(e);return/[&<>"']/.test(n)?n.replace(/[&<>"']/g,c):n},include:function(n,t){var r=this.templates.get(n);if(!r)throw e('Could not fetch template "'+n+'"');return r(t,this)},parse:{exec:"",interpolate:"=",raw:"~"},plugins:[],rmWhitespace:!1,tags:["<%","%>"],templates:d,useWith:!1,varName:"it"};function h(e,n){var t={};return r(t,g),n&&r(t,n),e&&r(t,e),t}function v(e){return r(g,e)}function m(n,t){var r=h(t||{}),a=r.async?function(){try{return new Function("return (async function(){}).constructor")()}catch(n){throw n instanceof SyntaxError?e("This environment doesn't support async/await"):n}}():Function;try{return new a(r.varName,"E","cb",f(n,r))}catch(t){throw t instanceof SyntaxError?e("Bad template syntax\n\n"+t.message+"\n"+Array(t.message.length+1).join("=")+"\n"+f(n,r)+"\n"):t}}function x(e,n){if(n.cache&&n.name&&n.templates.get(n.name))return n.templates.get(n.name);var t="function"==typeof e?e:m(e,n);return n.cache&&n.name&&n.templates.define(n.name,t),t}function y(n,r,a,i){var c=h(a||{});if(!c.async)return x(n,c)(r,c);if(!i){if("function"==typeof t)return new t((function(e,t){try{e(x(n,c)(r,c))}catch(e){t(e)}}));throw e("Please provide a callback function, this env doesn't support Promises")}try{x(n,c)(r,c,i)}catch(e){return i(e)}}function _(e,n,t,r){return y(e,n,Object.assign({},t,{async:!0}),r)}export{m as compile,f as compileToString,g as config,v as configure,g as defaultConfig,h as getConfig,p as parse,y as render,_ as renderAsync,d as templates};
//# sourceMappingURL=eta.es.min.js.map
